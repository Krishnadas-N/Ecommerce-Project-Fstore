<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">

<link href="/stylesheets/USER/UserProfile.css" rel="stylesheet">
<!-- Include Bootstrap JavaScript and jQuery -->

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>


<%- include('userSidePartials/UserHeader') %>

<%- include('userSidePartials/UserMobileHeader') %>

<div id="errorPopup" class="error-popup">
    <span id="errorIcon" class="error-icon">&#9888;</span>
    <span id="errorMessage" class="error-message"></span>
    <span id="closePopup" class="close-popup" onclick="closeErrorPopup()">X</span>
  </div>

<% if(profileMsg && profileMsg!='') {%>
    <input type="hidden" id="profileMessage" value="<%= profileMsg  %>">
    <% } %>
<main class="main">
    <div class="page-header breadcrumb-wrap">
        <div class="container">
            <div class="breadcrumb">
                <a href="index.html" rel="nofollow">Home</a>
                <span></span> Pages
                <span></span> Account
            </div>
        </div>
    </div>
    <section class="pt-150 pb-150">
        <div class="container">
            <div class="row">
                <div class="col-lg-10 m-auto">
                    <div class="row">
                        <div class="col-md-4">
                            <div class="dashboard-menu">
                                <ul class="nav flex-column" role="tablist">
                                    <li class="nav-item">
                                        <a class="nav-link active" id="dashboard-tab" data-bs-toggle="tab" href="#dashboard" role="tab" aria-controls="dashboard" aria-selected="false"><i class="fi-rs-settings-sliders mr-10"></i>Dashboard</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" id="Edit-Profile-tab" data-bs-toggle="tab" href="#Edit-Profile" role="tab" aria-controls="Edit-Profile" aria-selected="true"><i class="fi-rs-user mr-10"></i>Edit Account</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" id="orders-tab" data-bs-toggle="tab" href="#orders" role="tab" aria-controls="orders" aria-selected="false"><i class="fi-rs-shopping-bag mr-10"></i>Orders</a>
                                    </li>
                                    <!-- <li class="nav-item">
                                        <a class="nav-link" id="track-orders-tab" data-bs-toggle="tab" href="#track-orders" role="tab" aria-controls="track-orders" aria-selected="false"><i class="fi-rs-shopping-cart-check mr-10"></i>Track Your Order</a>
                                    </li> -->
                                    <li class="nav-item">
                                        <a class="nav-link" id="address-tab" data-bs-toggle="tab" href="#address" role="tab" aria-controls="address" aria-selected="true"><i class="fi-rs-marker mr-10"></i>My Address</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" id="account-detail-tab" data-bs-toggle="tab" href="#account-detail" role="tab" aria-controls="account-detail" aria-selected="true"><i class="fi-rs-user mr-10"></i>Personal Wallet</a>
                                    </li>
                                     <li class="nav-item">
                                        <a class="nav-link" id="Share-link-tab" data-bs-toggle="tab" href="#referralTab" role="tab" aria-controls="referralTab" aria-selected="true"><i class="fi-rs-user mr-10"></i>Referrals</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" href="/logout"><i class="fi-rs-sign-out mr-10"></i>Logout</a>
                                    </li>
                                </ul>
                            </div>
                        </div>



                        <div class="col-md-8">
                            <div class="tab-content dashboard-content">


                                <div class="tab-pane fade active show" id="dashboard" role="tabpanel" aria-labelledby="dashboard-tab">
                                    <div class="card">
                                      
                                          <div class="card-header" style="background-color: #000;">
                                            <div class="rounded-top text-white d-flex flex-row" style="height: 200px;">
                                              <div class="ms-4 mt-5 d-flex flex-column" style="width: 150px;">
                                                <img id="profile-image" src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-profiles/avatar-1.webp"
                                                  alt="Profile Image" class="img-fluid img-thumbnail mt-4 mb-2" style="width: 150px; z-index: 1">
                                                <label for="image-upload" class="btn btn-outline-dark" data-mdb-ripple-color="dark" style="z-index: 1;">Upload Image</label>
                                                <input type="file" id="image-upload" style="display: none;">
                                              </div>
                                              <div class="ms-3" style="margin-top: 130px;">
                                                <h5>Andy Horwitz</h5>
                                                <p>New York</p>
                                              </div>
                                            </div>
                                          </div>
                                                    <div class="p-4 text-black" style="background-color: #f8f9fa;">
                                                      <div class="justify-content-center text-center py-1" style="margin-top: 50px;">
                                                        
                                                        <h4>Profile Details</h4>
                                                       
                                                        <div class="d-flex justify-content-center ">
                                                          
                                                                          <div class="table-responsive w-100 border-0 bg-transparent" style="border: none;">
                                                                            <table class="table mb-0 border-0 text-md-center" style="border: none;" >
                                                                             
                                                                              <tbody>
                                                                                <tr>
                                                                                  <td>First Name </td>
                                                                                  <td><%= userDetails.firstName %></td>
                                                                                </tr>
                                                                                <tr>
                                                                                    <td>Last Name </td>
                                                                                    <td><%= userDetails.lastName %></td>
                                                                                  </tr>
                                                                                  <tr>
                                                                                    <td>Email </td>
                                                                                    <td><%= userDetails.email %></td>
                                                                                  </tr>
                                                                                  <tr>
                                                                                    <td>Gender </td>
                                                                                    <td><%= userDetails.gender %></td>
                                                                                  </tr>
                                                                                  <tr>
                                                                                    <td>Mobile </td>
                                                                                    <td><%= userDetails.mobile %></td>
                                                                                  </tr>
                                                                              </tbody>
                                                                            </table>
                                                                          </div>
                                                                       
                                                              
                                                        </div>
                                                      
                                                        <!-- //Change password / -->
                                                        <div class="row mt-4 w-75 mx-auto">
                                                            <button type="button" id="changePasswordbtn" class="btn">
                                                                <span id="spinner" class="spinner-border spinner-border-sm d-none" role="status" aria-hidden="true"></span>
                                                                Change Password
                                                            </button>
                                                        </div>
                                                        
                                                       
                                                      </div>
                                                    </div>
                                                    
                                                  
                                    </div>
                                </div>

                                <div class="tab-pane fade" id="orders" role="tabpanel" aria-labelledby="orders-tab">
                                  <div class="row" style="border: 1px solid black; background: rgb(240, 239, 239);">
                                      <div class="col">
                                          <div id="orders-container"></div>
                              
                                          <div class="pagination-area">
                                              <nav aria-label="Page navigation">
                                                  <ul id="pagination" class="pagination justify-content-center">
                                                      <!-- Pagination links will be appended here -->
                                                  </ul>
                                              </nav>
                                          </div>
                                      </div>
                                  </div>
                              </div>
                              






                                <div class="tab-pane fade" id="address" role="tabpanel" aria-labelledby="address-tab">
                                    <!-- Button to trigger the modal -->
                            <div class="row d-flex justify-content-end mb-4">
                                <button class="btn btn-primary" id="openModalButton" data-toggle="modal" data-target="#addressModal">Add Address</button>
                            </div>

                                            <!-- The modal -->
                                            <div class="modal fade" id="addressModal" tabindex="-1" role="dialog" aria-labelledby="addressModalLabel" aria-hidden="true">
                                                <div class="modal-dialog">
                                                    <div class="modal-content modal-dialog-scrollable">
                                                        <div class="modal-header">
                                                            <h5 class="modal-title" id="addressModalLabel">Add Address</h5>
                                                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                                <span aria-hidden="true">&times;</span>
                                                            </button>
                                                        </div>
                                                    <div class="modal-body">
                                                        <!-- Your form content goes here -->
                                                        <form id="addressForm">
                                                            <!-- Form fields for address details -->
                                                            <div class="form-group mb-3">
                                                                <label for="addressType">Address Type</label>
                                                                <select class="form-control" id="addressType" name="addressType">
                                                                    <option value="home">Home</option>
                                                                    <option value="work">Work</option>
                                                                    <option value="temp">Temporary</option>
                                                                </select>
                                                                <span id="addressTypeError" class="text-danger"></span>
                                                            </div>
                                                            <div class="form-group mb-3">
                                                                <label for="houseNo">House No</label>
                                                                <input type="text" class="form-control" id="houseNo" placeholder="House Number">
                                                                <span  id="houseNoError" class="text-danger"></span>
                                                            </div>
                                                            <div class="form-group mb-3">
                                                                <label for="street">Street</label>
                                                                <input type="text" class="form-control" id="street" placeholder="Street">
                                                                <span id="streetError" class="text-danger"></span>
                                                            </div>
                                                            <div class="form-group mb-3">
                                                                <label for="landmark" >Landmark</label>
                                                                <input type="text" class="form-control" id="landmark" placeholder="Landmark">
                                                               
                                                            </div>
                                                            <div class="form-group mb-3">
                                                                <label for="pincode">Pincode</label>
                                                                <input type="number" class="form-control" id="pincode" placeholder="Pincode">
                                                                <span id="pincodeError" class="text-danger"></span>
                                                            </div>
                                                            <div class="form-group mb-3">
                                                                <label for="city" >City</label>
                                                                <input type="text" class="form-control" id="city" placeholder="City">
                                                                <span id="cityError" class="text-danger"></span>
                                                            </div>
                                                            <div class="form-group mb-3">
                                                                <label for="district" >District</label>
                                                                <input type="text" class="form-control" id="district" placeholder="district">
                                                                <span id="districtError" class="text-danger"></span>
                                                            </div>
                                                            <div class="form-group mb-3">
                                                                <label for="state" class="mb-2 d-block">State</label>
                                                                <select id="state" class="form-control border"  name="state">
                                                                    <option value="">Select A State</option>
                                                                    <option value="Andhra Pradesh" >Andhra Pradesh</option>
                                                                    <option value="Arunachal Pradesh" >Arunachal Pradesh</option>
                                                                    <option value="Assam" >Assam</option>
                                                                    <option value="Bihar" >Bihar</option>
                                                                    <option value="Chhattisgarh" >Chhattisgarh</option>
                                                                    <option value="Goa" >Goa</option>
                                                                    <option value="Gujarat" >Gujarat</option>
                                                                    <option value="Haryana">Haryana</option>
                                                                    <option value="Himachal Pradesh" >Himachal Pradesh</option>
                                                                    <option value="Jharkhand" >Jharkhand</option>
                                                                    <option value="Karnataka" >Karnataka</option>
                                                                    <option value="Kerala" >Kerala</option>
                                                                    <option value="Madhya Pradesh" >Madhya Pradesh</option>
                                                                    <option value="Maharashtra" >Maharashtra</option>
                                                                    <option value="Manipur" >Manipur</option>
                                                                    <option value="Meghalaya">Meghalaya</option>
                                                                    <option value="Mizoram" >Mizoram</option>
                                                                    <option value="Nagaland" >Nagaland</option>
                                                                    <option value="Odisha" >Odisha</option>
                                                                    <option value="Punjab" >Punjab</option>
                                                                    <option value="Rajasthan">Rajasthan</option>
                                                                    <option value="Sikkim" >Sikkim</option>
                                                                    <option value="Tamil Nadu" >Tamil Nadu</option>
                                                                    <option value="Telangana">Telangana</option>
                                                                    <option value="Tripura" >Tripura</option>
                                                                    <option value="Uttar Pradesh">Uttar Pradesh</option>
                                                                    <option value="Uttarakhand" >Uttarakhand</option>
                                                                    <option value="West Bengal" >West Bengal</option>
                                                                    <!-- Your state options will be dynamically added here -->
                                                                </select>
                                                                <span id="stateError" class="text-danger"></span>
                                                                
                                                            </div>
                                                            <div class="form-group mb-3">
                                                                <label for="country">Country</label>
                                                                <input type="text" class="form-control" id="country" placeholder="Country">
                                                                <span  id="countryError" class="text-danger"></span>
                                                            </div>
                                                        </form>
                                                    </div>
                                                    <div class="modal-footer">
                                                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>

                                                        <button type="button" class="btn btn-primary" id="saveAddress">Save</button>
                                                    </div>
                                                </div>
                                            </div>
                                                </div>

                                    <div class="row">
                                        <% if(addresses && addresses.addresses.length>0){ %>
                                        <% addresses.addresses.forEach((item,index)=>{ %>
                                        <div class="col-lg-12">
                                            <div class="card">
                                                <% if(item.addressType=== 'temp' ){ %>
                                                <div class="card-header">
                                                    <h5 class="mb-0">Temporary Address</h5>
                                                </div>
                                            <% }else{ %>
                                                <div class="card-header">
                                                    <h5 class="mb-0"><%= item.addressType.toUpperCase() %> Address</h5>
                                                </div>
                                           <% } %>
                                                <div class="card-body">
                                                    <address>
                                                        <%= item.HouseNo %> <%= item.Street %><br>
                                                        <%= item.city %>, <%= item.State %> <%= item.pincode %> <%= item.Country %><br>
                                                        
                                                    </address>
                                                    <p><%= item.district %></p>
                                                </div>
                                                <div class="card-footer d-flex  justify-content-between">
                                                    <button class="btn" data-toggle="modal" data-target="#editAddressModal<%= index %>" data-index="<%= index %>">Edit</button>
                                                    <button class="btn" type="button"  onclick="addressRemove('<%= item.addressType  %>')">Remove</button>
                                                </div>
                                            </div>
                                        </div>
                                              
                                <!-- Modal for Editing Address -->
                                <div class="modal" id="editAddressModal<%= index %>">
                                    <div class="modal-dialog">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <h5 class="modal-title">Edit Address</h5>
                                                <button type="button" class="close" data-dismiss="modal">&times;</button>
                                            </div>
                                            <div class="modal-body">
                                                <form id="editaddressForm" action="/profile/editAddress" method="post" >
                                                    <!-- Form fields for address details -->
                                                    <div class="form-group mb-3">
                                                        <label for="addressType">Address Type</label>
                                                        <select class="form-control" id="editAddressType" value="<%= item.addressType %>" name="addressType" required>
                                                            <option value="home" <% if (item.addressType === 'home') { %>selected<% } %>>Home</option>
                                                            <option value="work" <% if (item.addressType === 'work') { %>selected<% } %>>Work</option>
                                                            <option value="temp" <% if (item.addressType === 'temp') { %>selected<% } %>>Temporary</option>
                                                        </select>
                                                        <span id="addressTypeError" class="text-danger"></span>
                                                    </div>
                                                    <div class="form-group mb-3">
                                                        <label for="houseNo">House No</label>
                                                        <input type="text" class="form-control" id="editHouseNo" required name="HouseNo" value="<%= item.HouseNo %>" placeholder="House Number">
                                                        <span id="edithouseNoError" class="text-danger"></span>
                                                    </div>
                                                    <div class="form-group mb-3">
                                                        <label for="street">Street</label>
                                                        <input type="text" class="form-control" id="editStreet" required name="Street"  value="<%= item.Street %>" placeholder="Street">
                                                        <span id="editstreetError" class="text-danger"></span>
                                                    </div>
                                                    <div class="form-group mb-3">
                                                        <label for="landmark" >Landmark</label>
                                                        <input type="text" class="form-control" id="landmark"  name="Landmark"  placeholder="Landmark">
                                                       
                                                    </div>
                                                    <div class="form-group mb-3">
                                                        <label for="pincode">Pincode</label>
                                                        <input type="number" class="form-control" id="pincode" required name="pincode" value="<%= item.pincode %>"placeholder="Pincode">
                                                        <span id="editpincodeError" class="text-danger"></span>
                                                    </div>
                                                    <div class="form-group mb-3">
                                                        <label for="city" >City</label>
                                                        <input type="text" class="form-control" id="city" name="city" required value="<%= item.city %>"  placeholder="City">
                                                        <span id="editcityError" class="text-danger"></span>
                                                    </div>
                                                    <div class="form-group mb-3">
                                                        <label for="district" >District</label>
                                                        <input type="text" class="form-control" id="district" required value="<%= item.district %>" name="district" placeholder="district">
                                                        <span id="editdistrictError" class="text-danger"></span>
                                                    </div>
                                                    <div class="form-group mb-3">
                                                        <label for="state" class="mb-2 d-block">State</label>
                                                        <select id="state" class="form-control border" required name="state">
                                                            <option value="">Select A State</option>
                                                            <option value="Andhra Pradesh" <% if (item.State === 'Andhra Pradesh') { %>selected<% } %>>Andhra Pradesh</option>
                                                            <option value="Arunachal Pradesh" <% if (item.State === 'Arunachal Pradesh') { %>selected<% } %>>Arunachal Pradesh</option>
                                                            <option value="Assam" <% if (item.State === 'Assam') { %>selected<% } %>>Assam</option>
                                                            <option value="Bihar" <% if (item.State === 'Bihar') { %>selected<% } %>>Bihar</option>
                                                            <option value="Chhattisgarh" <% if (item.State === 'Chhattisgarh') { %>selected<% } %>>Chhattisgarh</option>
                                                            <option value="Goa" <% if (item.State === 'Goa') { %>selected<% } %>>Goa</option>
                                                            <option value="Gujarat" <% if (item.State === 'Gujarat') { %>selected<% } %>>Gujarat</option>
                                                            <option value="Haryana" <% if (item.State === 'Haryana') { %>selected<% } %>>Haryana</option>
                                                            <option value="Himachal Pradesh" <% if (item.State === 'Himachal Pradesh') { %>selected<% } %>>Himachal Pradesh</option>
                                                            <option value="Jharkhand" <% if (item.State === 'Jharkhand') { %>selected<% } %>>Jharkhand</option>
                                                            <option value="Karnataka" <% if (item.State === 'Karnataka') { %>selected<% } %>>Karnataka</option>
                                                            <option value="Kerala" <% if (item.State === 'Kerala') { %>selected<% } %>>Kerala</option>
                                                            <option value="Madhya Pradesh" <% if (item.State === 'Madhya Pradesh') { %>selected<% } %>>Madhya Pradesh</option>
                                                            <option value="Maharashtra" <% if (item.State === 'Maharashtra') { %>selected<% } %>>Maharashtra</option>
                                                            <option value="Manipur" <% if (item.State === 'Manipur') { %>selected<% } %>>Manipur</option>
                                                            <option value="Meghalaya" <% if (item.State === 'Meghalaya') { %>selected<% } %>>Meghalaya</option>
                                                            <option value="Mizoram" <% if (item.State === 'Mizoram') { %>selected<% } %>>Mizoram</option>
                                                            <option value="Nagaland" <% if (item.State === 'Nagaland') { %>selected<% } %>>Nagaland</option>
                                                            <option value="Odisha" <% if (item.State === 'Odisha') { %>selected<% } %>>Odisha</option>
                                                            <option value="Punjab" <% if (item.State === 'Punjab') { %>selected<% } %>>Punjab</option>
                                                            <option value="Rajasthan" <% if (item.State === 'Rajasthan') { %>selected<% } %>>Rajasthan</option>
                                                            <option value="Sikkim" <% if (item.State === 'Sikkim') { %>selected<% } %>>Sikkim</option>
                                                            <option value="Tamil Nadu" <% if (item.State === 'Tamil Nadu') { %>selected<% } %>>Tamil Nadu</option>
                                                            <option value="Telangana" <% if (item.State === 'Telangana') { %>selected<% } %>>Telangana</option>
                                                            <option value="Tripura" <% if (item.State === 'Tripura') { %>selected<% } %>>Tripura</option>
                                                            <option value="Uttar Pradesh" <% if (item.State === 'Uttar Pradesh') { %>selected<% } %>>Uttar Pradesh</option>
                                                            <option value="Uttarakhand" <% if (item.State === 'Uttarakhand') { %>selected<% } %>>Uttarakhand</option>
                                                            <option value="West Bengal" <% if (item.State === 'West Bengal') { %>selected<% } %>>West Bengal</option>
                                                            <!-- Add more states as needed -->
                                                        </select>
                                                        <span id="editstateError" class="text-danger"></span>
                                                    </div>
                                                                                                        <div class="form-group mb-3">
                                                        <label for="country">Country</label>
                                                        <input type="text" required class="form-control" id="country" value="<%= item.Country %>" name="Country" placeholder="Country">
                                                        <span  id="editcountryError" class="text-danger"></span>
                                                    </div>
                                                    <!-- Other address fields here... -->
                                              
                                            </div>
                                            <div class="modal-footer">
                                                <button type="submit" class="btn btn-primary">Save</button>
                                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                            </div>
                                        </form>
                                        </div>
                                    </div>
                                </div>
                                    <% }) %>
                                    <% }else{ %>
                                        <div class="col-lg-12">
                                            <h5>Not Address Found</h5>
                                        </div>
                                         <% } %> 
                                    </div>
                                </div>



                                <div class="tab-pane fade" id="account-detail" role="tabpanel" aria-labelledby="account-detail-tab">
                                    <div class="card">
                                      
                                        <div class="card-body">
                                            <div class="wallet-container text-center">
                                                <p class="page-title"><i class="fa fa-align-left"></i>My E-wallet<i class="fa fa-user"></i></p>
                                                <% if (userDetails.WalletDetails) { %>
                                                <div class="amount-box text-center">
                                                    <img src="https://lh3.googleusercontent.com/ohLHGNvMvQjOcmRpL4rjS3YQlcpO0D_80jJpJ-QA7-fQln9p3n7BAnqu3mxQ6kI4Sw" alt="wallet">
                                                   
                                                    <p>Total Balance</p>
                                                    <p class="amount">₹ <%= userDetails.WalletDetails.balance %></p>
                                                </div>
                                        
                                                <div class="btn-group text-center">
                                                    <button type="button" class="btn btn-outline-light" onclick="addMoneyToWallet('<%= userDetails._id %>')">Add Money</button>
                                                    <button onclick="showWithdrawalPrompt('<%= userDetails.WalletDetails.balance %>')" class="btn btn-outline-light">Withdraw</button>


                                                    </div>
                                        
                                                    <div class="txn-history">
                                                        <p><b>History</b></p>
                                                        <% userDetails.WalletDetails.transactions.slice().reverse().forEach((transaction,index)=>{  %>
                                                            <% if(index<5){ %>
                                                                <p class="txn-list">
                                                                    <% if (transaction.type === 'debit') { %>
                                                                      Debited <span class="debit-amount">-₹<%= Math.abs(transaction.amount) %></span>
                                                                      <% if (transaction.description) { %>
                                                                        <span class="debit-description">- <%= transaction.description %></span>
                                                                      <% } %>
                                                                    <% } else if (transaction.type === 'credit') { %>
                                                                      Credited <span class="credit-amount">+₹<%= transaction.amount %></span>
                                                                      <% if (transaction.description) { %>
                                                                        <span class="credit-description">+ <%= transaction.description %></span>
                                                                      <% } %>
                                                                    <% } %>
                                                                  </p>
                                                                  
                                                        <% } %>
                                                            <% }) %>
                                                    </div>
                                                    <% } else { %>
                                                      <p>No wallet details available.</p>
                                                    <% } %>
                                                    <div class="footer-menu"></div>
                                        
                                        </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="tab-pane fade" id="referralTab" role="tabpanel" aria-labelledby="track-orders-tab">
                                    <div class="card">
                                        <div class="card p-3 text-center">
        
                                            <div class="position-relative">
                                                
                                                <img src="https://i.imgur.com/iicvsZ6.png">
                                                <!-- <span class="dots"><i class="fa fa-plus"></i></span> -->
                                            </div>
                                            
                                            <div>
                                                <h5>Invite & Earn</h5>
                                                <span class="earn-text">Be a trendsetter! Introduce your circle to the next big thing F-STORE. <br>  Your influence, your rewards</span>
                                            </div>
                                            
                                            
                                            <div class="px-3 mt-2">
                                                <div class="d-flex justify-content-between align-items-center">
                                                    <span>$0</span>
                                                    <span>$45,000</span>
                                                </div>
                                                <div class="progress" style="height:4px;">
                                                  <div class="progress-bar bg-danger" role="progressbar" style="width: 50%" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100"></div>
                                                </div>
                                                
                                            </div>
                                            
                                            <div class="px-3 mt-2 d-flex justify-content-end ">
                                                
                                                <button type="button" class="btn btn-primary text-uppercase" data-bs-toggle="modal" data-bs-target="#myModel" id="shareBtn" data-bs-placement="top" title="Click Me!">
                                                    Share 
                                                </button>
                                            </div>
                                            
                                          
                                            
                                            <div class="mt-3 px-3 d-flex justify-content-between align-items-center">
                                              
                                                
                                                
                                                
                                            </div>
                                            
                                            
                                            
                                            
                                        </div>
                                    </div>
                                </div>


                                <!-- Edit Profile -->
                                <div class="tab-pane fade" id="Edit-Profile" role="tabpanel" aria-labelledby="Edit-Profile-tab">
                                    <div class="card border-0">
                                        <div class="card-header bg-transparent text-center">
                                            <h5 class="mb-0">Edit Account</h5>
                                        </div>
                                        <form id="editprofile" >
                                            <!-- 2 column grid layout with text inputs for the first and last names -->
                                            <div class="row mb-4">
                                              <div class="col">
                                                <div class="form-outline">
                                                    <label class="form-label" for="form6Example1">First name</label>
                                                  <input type="text" id="form6Example1" value="<%= userDetails.firstName  %>" name="firstName" required class="form-control" />
                                                 
                                                </div>
                                                <span id="firstNameError" class="error-message"></span>
                                              </div>
                                              <div class="col">
                                                <div class="form-outline">
                                                    <label class="form-label" for="form6Example2">Last name</label>
                                                  <input type="text" id="form6Example2" value="<%= userDetails.lastName  %>" name="lastName" required class="form-control" />
                                                  <span id="lastNameError" class="error-message text-danger"></span>
                                                </div>
                                                
                                              </div>
                                            </div>
                                          
                          
                                            <!-- Email input -->
                                            <div class="form-outline mb-4">
                                                <label class="form-label" for="form6Example5">Email</label>
                                              <input type="email" id="form6Example5" value="<%= userDetails.email  %>" name="email" required class="form-control" />
                                              <span id="emailError" class="error-message text-danger"></span>
                                            </div>
                                          
                                            
                                              
                                              <div class="form-outline ">
                                                <label class="form-label" for="form6Example9">Gender</label>
                                              
                                                <div class="form-check">
                                                  <input class="form-check-input" type="radio" name="gender" id="male" value="male" <%= userDetails.gender === "male" ? "checked" : "" %> />
                                                  <label class="form-check-label" for="male">Male</label>
                                                </div>
                                              
                                                <div class="form-check">
                                                  <input class="form-check-input" type="radio" name="gender" id="female" value="female" <%= userDetails.gender === "female" ? "checked" : "" %> />
                                                  <label class="form-check-label" for="female">Female</label>
                                                </div>
                                              
                                                <div class="form-check">
                                                  <input class="form-check-input" type="radio" name="gender" id="others" value="others" <%= userDetails.gender === "others" ? "checked" : "" %> />
                                                  <label class="form-check-label" for="others">Others</label>
                                                </div>
                                              </div>
                                              
                                            
                                          
                                            <!-- Number input -->
                                            <div class="form-outline mb-4">
                                                <label class="form-label" for="form6Example6">Phone</label>
                                              <input type="number" id="form6Example6" value="<%= userDetails.mobile  %>" name="mobile" required class="form-control" />
                                              <span id="mobileError" class="error-message text-danger"></span>
                                            </div>
                                        
                                          
                                          
                                            <!-- Checkbox -->
                                            <!-- <div class="form-check d-flex justify-content-center mb-4">
                                              <input class="form-check-input me-2" type="checkbox" value="" id="form6Example8" checked />
                                              <label class="form-check-label" for="form6Example8"> Create an account? </label>
                                            </div> -->
                                          
                                            <!-- Submit button -->
                                            <!-- Button to open the first modal -->
                                        <!-- Button to open the user contact details modal -->
                                        <!-- Button to open the user contact details modal -->
                                            <button id="openModal" type="submit" class="btn btn-primary btn-block mb-4">Save Changes</button>
                                            </form>
                                        </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</main>

<!-- //Modals -->
<!-- Example return modal element -->
<div class="modal fade" id="returnModal" tabindex="-1" aria-labelledby="returnModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="returnModalLabel">Enter Return Reason</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" onclick="closeModal()" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <label for="returnReason" class="form-label">Reason for Return:</label>
                <textarea class="form-control" id="returnReason" rows="3"></textarea>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeModal()" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" onclick="submitReturn()">Submit Return</button>
            <!-- Spinner -->
        <div class="spinner-border text-primary" role="status" id="submitReturnSpinner" style="display: none;">
            <span class="visually-hidden">Loading...</span>
        </div>
            </div>
        </div>
    </div>
</div>


<!-- REFERRAL MODAL -->
<!-- Modal -->
<div class="modal fade" id="myModel" tabindex="-1" aria-labelledby="myModelLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="myModelLabel">Share Modal</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>Share this link via</p>
                <div class="d-flex align-items-center icons">                
                    <a href="https://www.facebook.com/sharer/sharer.php?u=<%= generatedRefLink %>" class="fs-5 d-flex align-items-center justify-content-center" target="_blank">
                        <span class="fab fa-facebook-f"></span>
                    </a>
                                   
                    <a href="https://twitter.com/intent/tweet?url=YOUR_URL&text=<%= generatedRefLink %>" class="fs-5 d-flex align-items-center justify-content-center" target="_blank">
                        <span class="fab fa-twitter"></span>
                    </a>                
                    <a href="https://www.instagram.com/share?url=<%= generatedRefLink %>" class="fs-5 d-flex align-items-center justify-content-center" target="_blank">
                        <span class="fab fa-instagram"></span>
                    </a>                
                    <a href="https://api.whatsapp.com/send?text=<%= generatedRefLink %>" class="fs-5 d-flex align-items-center justify-content-center" target="_blank">
                        <span class="fab fa-whatsapp"></span>
                    </a>                
                    <a href="https://t.me/share/url?url=<%= generatedRefLink %>" class="fs-5 d-flex align-items-center justify-content-center" target="_blank">
                        <span class="fab fa-telegram-plane"></span>
                    </a>
                </div>
                
                <p>Or copy link</p>
                <div class="field d-flex align-items-center justify-content-between">
                    <span class="fas fa-link text-center"></span>
                    <input type="text" value="<%= generatedRefLink %>">
                    <button id="copyButton">Copy</button>
                </div>
            </div>
        </div>
    </div>
</div>


<!-- User Contact Details Modal -->
<div class="modal fade" id="userContactModal" tabindex="-1" aria-labelledby="userContactModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="userContactModalLabel">User Contact Details</h5>
                <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <p>Email: <%= userDetails.email %></p>
                <!-- Button to request OTP -->
                <button id="requestOTPButton" class="btn btn-primary">Request OTP</button>
            </div>
        </div>
    </div>
</div>

<!-- OTP Verification Modal -->
<div class="modal fade" id="otpVerificationModal" tabindex="-1" aria-labelledby="otpVerificationModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="otpVerificationModalLabel">OTP Verification</h5>
                <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <p>Enter the OTP received on your email:</p>
                <input type="text" id="otpInput" class="form-control">
                <button id="verifyOTPButton" class="btn btn-primary mt-3">Verify OTP</button>
            </div>
        </div>
    </div>
</div>




<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://unpkg.com/cropperjs@1.5.12/dist/cropper.min.js"></script>

<script src="/javascripts/USER/PROFILEIMAGE.js"></script>


<script src="/javascripts/USER/ORDERLISTING.js"></script>

<script src="/javascripts/USER/UserProfile.js"></script>


<script src="https://checkout.razorpay.com/v1/checkout.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>


  
<%- include('userSidePartials/UserFooter') %>